## Блок 2. Структура базы данных

### Таблицы

1. **users** — пользователи бота  
   - user_id (PRIMARY KEY)  
   - username, first_name, last_name  
   - balance (REAL, default 0)  
   - role (user/moderator/admin)  
   - created_at  

2. **applications** — заявки на подтверждение  
   - id (PRIMARY KEY)  
   - user_id (FOREIGN KEY)  
   - status (pending/moderating/completed/rejected)  
   - queue_position (INTEGER)  
   - estimated_wait_time (INTEGER, секунды)  
   - moderator_id (FOREIGN KEY, nullable)  
   - created_at  
   - started_at (nullable)  
   - completed_at (nullable)  

3. **moderation_sessions** — активные сессии модерации  
   - id (PRIMARY KEY)  
   - application_id (FOREIGN KEY)  
   - user_id (FOREIGN KEY)  
   - moderator_id (FOREIGN KEY)  
   - user_photo_file_id (TEXT, nullable)  
   - moderator_photo_file_id (TEXT, nullable)  
   - status (active/completed)  
   - created_at  

4. **transactions** — история транзакций баланса  
   - id (PRIMARY KEY)  
   - user_id (FOREIGN KEY)  
   - amount (REAL)  
   - type (deposit/withdrawal)  
   - description (TEXT)  
   - created_at  

5. **moderator_stats** — статистика модераторов (для расчёта времени)  
   - moderator_id (FOREIGN KEY)  
   - total_sessions (INTEGER)  
   - total_time_seconds (INTEGER)  
   - average_session_time (REAL, вычисляемое поле)  


# –ë–ª–æ–∫ 7.2: –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä ‚Äî –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ /moderator –∏ –≤–æ –≤—Å–µ—Ö callback

## –¶–µ–ª—å

–ü—Ä–∏ –≤—Ö–æ–¥–µ –≤ –ø–∞–Ω–µ–ª—å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ (–∫–æ–º–∞–Ω–¥–∞ /moderator –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ –∏–∑ –º–µ–Ω—é) –∏ –ø—Ä–∏ –ª—é–±—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö –≤ –Ω–µ–π –æ–±–Ω–æ–≤–ª—è—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –≥–ª–∞–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∞ –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∏ –Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ¬´—Å–ª—É—á–∞–π–Ω–æ–µ¬ª —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π.

## –ö–æ–Ω—Ç–µ–∫—Å—Ç

- –°–µ–π—á–∞—Å `cmd_moderator` –≤—ã–∑—ã–≤–∞–µ—Ç `message.answer(...)` ‚Äî –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
- –í—Å–µ callback –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `callback.message.edit_text(...)` ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è —Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –∫–Ω–æ–ø–∫–∞. –ï—Å–ª–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä –∑–∞—à—ë–ª –ø–æ –∫–Ω–æ–ø–∫–µ –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é (–ø–æ—Å–ª–µ 7.1 —ç—Ç–æ –±—É–¥–µ—Ç —Ç–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ), —Ç–æ –≤—Å—ë –æ–∫; –µ—Å–ª–∏ –ø–æ /moderator ‚Äî —É–∂–µ –¥—Ä—É–≥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. –ß—Ç–æ–±—ã –≤–µ–∑–¥–µ –±—ã–ª–æ –æ–¥–Ω–æ, –Ω—É–∂–Ω–æ –≤—Å–µ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø–æ `main_message_id` —á–µ—Ä–µ–∑ `update_user_main_message` (–∏–ª–∏ `update_moderator_message` –¥–ª—è –∫–æ–º–∞–Ω–¥—ã).

–ò—Å–ø–æ–ª—å–∑—É–µ–º: `get_or_create_moderator_message`, `update_moderator_message` –∏–∑ `utils.moderator_messages`, `update_user_main_message` –∏–∑ `utils.user_messages` (—Ç–æ—Ç –∂–µ `main_message_id`).

## –ó–∞–¥–∞—á–∏

| ‚Ññ | –î–µ–π—Å—Ç–≤–∏–µ | –§–∞–π–ª |
|---|----------|------|
| 2.1 | –í `cmd_moderator`: —É–±—Ä–∞—Ç—å `message.answer(...)`; –≤—ã–∑—ã–≤–∞—Ç—å `get_or_create_moderator_message(bot, user_id, "üëÆ –ü–∞–Ω–µ–ª—å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞", get_moderator_panel_keyboard())` (–∏–ª–∏ `update_moderator_message`, –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —É–∂–µ –µ—Å—Ç—å). | `handlers/moderator_handlers.py` |
| 2.2 | –í–æ –≤—Å–µ—Ö callback –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ (`callback_moderator_panel`, `callback_moderator_pending_applications`, `callback_moderator_take_application`, `callback_moderator_active_sessions`, `callback_moderator_sessions_without_photo`, –∏ –¥–∞–ª–µ–µ –ø–æ —Å–ø–∏—Å–∫—É) –∑–∞–º–µ–Ω–∏—Ç—å `callback.message.edit_text(...)` –Ω–∞ `update_user_main_message(callback.bot, callback.from_user.id, text, reply_markup)`. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `update_user_main_message` –∏–∑ `utils.user_messages`. | `handlers/moderator_handlers.py` |

## –°–ø–∏—Å–æ–∫ callback –¥–ª—è –∑–∞–º–µ–Ω—ã

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –∑–∞–º–µ–Ω–∏—Ç—å –≤–æ –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö callback –≤ `moderator_handlers.py`, –≥–¥–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `callback.message.edit_text(...)`:

- `callback_moderator_panel`
- `callback_moderator_pending_applications`
- `callback_moderator_take_application`
- `callback_moderator_active_sessions`
- `callback_moderator_sessions_without_photo`
- –æ—Å—Ç–∞–ª—å–Ω—ã–µ callback (—Å–µ—Å—Å–∏–∏, —Ñ–æ—Ç–æ, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ, –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∏ —Ç.–¥.)

## –ß–µ–∫-–ª–∏—Å—Ç

- [x] `cmd_moderator`: –ø–æ–∫–∞–∑ –ø–∞–Ω–µ–ª–∏ —á–µ—Ä–µ–∑ `get_or_create_moderator_message` / `update_moderator_message`.
- [x] –í—Å–µ callback –≤ moderator_handlers: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `update_user_main_message`.

## –í—ã–ø–æ–ª–Ω–µ–Ω–æ

‚úÖ **–ó–∞–¥–∞—á–∞ 2.1**: –í `cmd_moderator` –∑–∞–º–µ–Ω—ë–Ω `message.answer(...)` –Ω–∞ `get_or_create_moderator_message` —Å —Ç–µ–∫—Å—Ç–æ–º "üëÆ –ü–∞–Ω–µ–ª—å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞" –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π –ø–∞–Ω–µ–ª–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞.

‚úÖ **–ó–∞–¥–∞—á–∞ 2.2**: –í–æ –≤—Å–µ—Ö callback –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ –∑–∞–º–µ–Ω—ë–Ω `callback.message.edit_text(...)` –Ω–∞ `update_user_main_message`. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:
- `callback_moderator_panel`
- `callback_moderator_pending_applications`
- `callback_moderator_take_application`
- `callback_moderator_active_sessions`
- `callback_moderator_sessions_without_photo`
- `callback_moderator_session`
- `callback_moderator_send_photo`
- `callback_moderator_approve`
- `callback_moderator_reject`
- `callback_moderator_stats`

‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã: `update_user_main_message` –∏–∑ `utils.user_messages` –∏ `get_or_create_moderator_message` –∏–∑ `utils.moderator_messages`.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (`process_moderator_photo`, `process_moderator_photo_invalid`) –æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Å `message.answer(...)`, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ñ–æ—Ç–æ), –∞ –Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç–∞.

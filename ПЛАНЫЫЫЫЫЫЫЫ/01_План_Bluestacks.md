---
name: Система подтверждения возраста КСО - Bluestacks
overview: Реализация системы для подтверждения возраста на КСО через Telegram бота и макрос на Android устройстве (Bluestacks). Пользователь отправляет QR код КСО боту, бот обрабатывает его через макрос на телефоне и возвращает QR код для считывателя.
device: Bluestacks (эмулятор Android)
root: Не требуется (можно использовать ADB команды для эмуляции биометрии)
---

# План реализации для Bluestacks

Этот план описывает реализацию системы на эмуляторе Bluestacks.

## Преимущества Bluestacks:

- Легко настроить виртуальную камеру (OBS Virtual Camera)
- ADB команды работают стабильно
- Можно эмулировать биометрию через системные команды
- Не требует физического устройства

## Особенности:

- Виртуальная камера настраивается один раз в настройках Bluestacks
- Биометрию можно эмулировать через ADB команды (`service call fingerprint`)
- Полная автоматизация без участия человека

## Основные компоненты:

1. Telegram бот
2. Координационный сервер (FastAPI)
3. Виртуальная камера (OBS Virtual Camera)
4. ADB автоматизация для Bluestacks
5. Модуль биометрии (эмуляция через ADB)

## Структура проекта:

```
money/
├── bot/                    # Telegram бот
├── server/                 # FastAPI сервер
├── macro/                  # Макросы и автоматизация
│   ├── virtual_camera.py   # Виртуальная камера
│   ├── biometric_handler.py # Эмуляция биометрии
│   └── qr_scanner.py       # Сканирование QR
└── config/                 # Конфигурация
```

## Ключевые технические детали:

### Виртуальная камера:
- OBS Virtual Camera устанавливается на Windows
- В Bluestacks выбирается как источник камеры
- Python транслирует QR код через виртуальную камеру

### Биометрия:
- Эмуляция через `adb shell service call fingerprint 1`
- Или через UI Automator (тап на кнопку подтверждения)
- Полная автоматизация без участия человека

### ADB подключение:
- `adb connect 127.0.0.1:5555` (стандартный порт Bluestacks)
- Управление через `adb shell` команды

## Полный план смотри в основном файле PLAN.md
